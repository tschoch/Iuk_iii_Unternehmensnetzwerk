enable
conf t
hostname R3
no ip domain-lookup
ipv6 unicast-routing
ipv6 router ospf 1
exit

interface s0/0/0
      ip address 10.4.40.6 255.255.255.252
      ipv6 address 2001:620:3101:4040::3/64
      ipv6 address FE80::3 link-local
      ipv6 enable
      ipv6 ospf 1 area 0
      no shutdown
      exit
      
interface g0/0.10
      encapsulation dot1q 10
      ip address 10.3.10.1 255.255.255.0
      ipv6 address 2001:620:3101:3010::3/64
      ipv6 address FE80::3 link-local
      ip helper-address 10.1.0.1
      ipv6 enable
      ipv6 ospf 1 area 0
      exit
      
interface g0/0.20
      encapsulation dot1q 20
      ip address 10.3.20.1 255.255.255.0
      ipv6 address 2001:620:3101:3020::3/64
      ipv6 address FE80::3 link-local
      ip helper-address 10.1.0.1
      ipv6 enable
      ipv6 ospf 1 area 0
      exit
      
interface g0/0.30
      encapsulation dot1q 30
      ip address 10.3.30.1 255.255.255.0
      ipv6 address 2001:620:3101:3030::3/64
      ipv6 address FE80::3 link-local
      ip helper-address 10.1.0.1
      ipv6 enable
      ipv6 ospf 1 area 0
      exit
      
interface g0/0.99
      encapsulation dot1q 99
      ip address 10.3.99.1 255.255.255.0
      ipv6 address 2001:620:3101:3099::3/64
      ipv6 address FE80::3 link-local
      ip helper-address 10.1.0.1
      ipv6 enable
      ipv6 ospf 1 area 0
      exit
      
interface g0/0
      no shutdown
      exit
      
router ospf 1
      	network 10.4.40.4 0.0.0.3 area 0
	network 10.3.10.0 0.0.0.255 area 0
	network 10.3.20.0 0.0.0.255 area 0
	network 10.3.30.0 0.0.0.255 area 0
	network 10.3.99.0 0.0.0.255 area 0
	passive-interface g0/0.10
	passive-interface g0/0.20
	passive-interface g0/0.30
	passive-interface g0/0.99
	exit
      


ip access-list extended 119
	deny ip 10.3.10.0 0.0.0.255 10.1.20.0 0.0.0.255 
	deny ip 10.3.10.0 0.0.0.255 10.1.30.0 0.0.0.255 
	deny ip 10.3.10.0 0.0.0.255 10.2.20.0 0.0.0.255 
	deny ip 10.3.10.0 0.0.0.255 10.2.30.0 0.0.0.255 
	deny ip 10.3.10.0 0.0.0.255 10.3.20.0 0.0.0.255 
	deny ip 10.3.10.0 0.0.0.255 10.3.30.0 0.0.0.255 
	permit ip any any
	permit tcp any any
exit

interface g0/0.10
ip access-group 119 in
exit

ip access-list extended 120
	deny ip 10.3.20.0 0.0.0.255 10.1.10.0 0.0.0.255 
	deny ip 10.3.20.0 0.0.0.255 10.1.30.0 0.0.0.255 
	deny ip 10.3.20.0 0.0.0.255 10.2.10.0 0.0.0.255 
	deny ip 10.3.20.0 0.0.0.255 10.2.30.0 0.0.0.255 
	deny ip 10.3.20.0 0.0.0.255 10.3.10.0 0.0.0.255 
	deny ip 10.3.20.0 0.0.0.255 10.3.30.0 0.0.0.255 
	permit ip any any
	permit tcp any any
exit

interface g0/0.20
ip access-group 120 in
exit

ip access-list extended 121
	deny ip 10.3.30.0 0.0.0.255 10.1.10.0 0.0.0.255
	deny ip 10.3.30.0 0.0.0.255 10.1.20.0 0.0.0.255
	deny ip 10.3.30.0 0.0.0.255 10.2.10.0 0.0.0.255
	deny ip 10.3.30.0 0.0.0.255 10.2.20.0 0.0.0.255
	deny ip 10.3.30.0 0.0.0.255 10.3.10.0 0.0.0.255
	deny ip 10.3.30.0 0.0.0.255 10.3.20.0 0.0.0.255
	permit ip any any
	permit tcp any any
exit

interface g0/0.30
ip access-group 121 in
exit


ipv6 access-list s103
	deny ip 2001:620:3101:3010::/64 2001:620:3101:1020::/64 
	deny ip 2001:620:3101:3010::/64 2001:620:3101:1030::/64 
	deny ip 2001:620:3101:3010::/64 2001:620:3101:2020::/64 
	deny ip 2001:620:3101:3010::/64 2001:620:3101:2030::/64 
	deny ip 2001:620:3101:3010::/64 2001:620:3101:3020::/64 
	deny ip 2001:620:3101:3010::/64 2001:620:3101:3030::/64 
	permit ip any any
	permit tcp any any
exit

interface g0/0.10
ipv6 traffic-filter s10 in
exit

ipv6 access-list s20
	deny ip 2001:620:3101:3020::/64 2001:620:3101:1010::/64 
	deny ip 2001:620:3101:3020::/64 2001:620:3101:1030::/64 
	deny ip 2001:620:3101:3020::/64 2001:620:3101:2010::/64 
	deny ip 2001:620:3101:3020::/64 2001:620:3101:2030::/64 
	deny ip 2001:620:3101:3020::/64 2001:620:3101:3010::/64 
	deny ip 2001:620:3101:3020::/64 2001:620:3101:3030::/64 
	permit ip any any
	permit tcp any any
exit

interface g0/0.20
ipv6 traffic-filter s20 in
exit


ipv6 access-list s30
	deny ip 2001:620:3101:3030::/64 2001:620:3101:1010::/64 
	deny ip 2001:620:3101:3030::/64 2001:620:3101:1020::/64 
	deny ip 2001:620:3101:3030::/64 2001:620:3101:2010::/64 
	deny ip 2001:620:3101:3030::/64 2001:620:3101:2020::/64 
	deny ip 2001:620:3101:3030::/64 2001:620:3101:3010::/64 
	deny ip 2001:620:3101:3030::/64 2001:620:3101:3020::/64 
	permit ip any any
	permit tcp any any
exit

interface g0/0.30
ipv6 traffic-filter s30 in
end
